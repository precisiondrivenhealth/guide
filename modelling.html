<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Health Data Science in Aotearoa New Zealand: A Practical Guide - 8&nbsp; Modelling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./evaluation.html" rel="next">
<link href="./data-preparation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-1SFLY01V14"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-1SFLY01V14', { 'anonymize_ip': true});
</script>


</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./img/logo-pdh.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Health Data Science in Aotearoa New Zealand: A Practical Guide</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
    <a href="https://github.com/precisiondrivenhealth/guide" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools ms-auto-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools ms-auto-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./modelling.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Modelling</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./img/noun-mandatory-1951351.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://precisiondrivenhealth.com" title="Precision Driven Health" class="quarto-navigation-tool px-1" aria-label="Precision Driven Health"><i class="bi bi-globe"></i></a>
    <a href="https://github.com/precisiondrivenhealth/guide" title="GitHub repository" class="quarto-navigation-tool px-1" aria-label="GitHub repository"><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./starting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">How do I start?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Understanding the basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./collaboration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">People, capability &amp; collaboration</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-landscape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The unique health data landscape</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-access.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Accessing and managing data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-identifiability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data identifiability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-preparation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data preparation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelling.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Modelling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Evaluation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./deployment-lifecycle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Deployment &amp; lifecycle maintenance</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#keep-in-mind" id="toc-keep-in-mind" class="nav-link active" data-scroll-target="#keep-in-mind"><span class="header-section-number">8.1</span> Keep in mind</a></li>
  <li><a href="#modelling-process" id="toc-modelling-process" class="nav-link" data-scroll-target="#modelling-process"><span class="header-section-number">8.2</span> Modelling process</a></li>
  <li><a href="#modelling-approaches" id="toc-modelling-approaches" class="nav-link" data-scroll-target="#modelling-approaches"><span class="header-section-number">8.3</span> Modelling approaches</a></li>
  <li><a href="#documentation-and-management" id="toc-documentation-and-management" class="nav-link" data-scroll-target="#documentation-and-management"><span class="header-section-number">8.4</span> Documentation and management</a></li>
  <li><a href="#modelling-tools" id="toc-modelling-tools" class="nav-link" data-scroll-target="#modelling-tools"><span class="header-section-number">8.5</span> Modelling tools</a></li>
  <li><a href="#experiment-tracking-tools" id="toc-experiment-tracking-tools" class="nav-link" data-scroll-target="#experiment-tracking-tools"><span class="header-section-number">8.6</span> Experiment tracking tools</a></li>
  <li><a href="#model-validation" id="toc-model-validation" class="nav-link" data-scroll-target="#model-validation"><span class="header-section-number">8.7</span> Model validation</a>
  <ul class="collapse">
  <li><a href="#data-partitioning" id="toc-data-partitioning" class="nav-link" data-scroll-target="#data-partitioning"><span class="header-section-number">8.7.1</span> Data partitioning</a></li>
  <li><a href="#performance-metrics" id="toc-performance-metrics" class="nav-link" data-scroll-target="#performance-metrics"><span class="header-section-number">8.7.2</span> Performance metrics</a></li>
  </ul></li>
  <li><a href="#useful-resources" id="toc-useful-resources" class="nav-link" data-scroll-target="#useful-resources"><span class="header-section-number">8.8</span> Useful resources</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/precisiondrivenhealth/guide/edit/main/modelling.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Modelling</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>The word “modelling” is used broadly to describe the process of analysis involved in data science. In this guide, a ‘model’ is a simplified quantitative representation of a real world situation, which often answers a specific question. Modelling can be used to help derive insights or drive decision making.</p>
<section id="keep-in-mind" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="keep-in-mind"><span class="header-section-number">8.1</span> Keep in mind</h2>
<ul>
<li>Apply an equity lens all the way through the model lifecycle: consider who is benefiting from a model, who is vulnerable, and who is excluded. This lens should inform the data chosen, how the data is processed, algorithm choice, how the model is evaluated, and how the model is used</li>
<li>Closely engage with the stakeholders and data providers (see <a href="./collaboration.html#end-user-engagement">End-user engagement</a>)</li>
<li>Maintain clinician engagement throughout</li>
<li>Have good quality documentation to share the work with others (see <a href="./data-access.html#data-management">Documentation and management</a>)</li>
<li>Version control the code base so that work is reproducible (see <a href="./data-access.html#data-management">Documentation and management</a>)</li>
<li>Check data quality and availability including operational concerns, sanity checking and bias (see <a href="./data-preparation.html#data-quality">Data quality</a>)</li>
<li>Consider your audience when presenting data (see Transparency, interpretability and explanation).</li>
</ul>
<p>This guidance is applicable to any analytical technique.</p>
</section>
<section id="modelling-process" class="level2 page-columns page-full" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="modelling-process"><span class="header-section-number">8.2</span> Modelling process</h2>
<p>Although details can differ from case to case, there are several general modelling process steps and principles that can help achieve good results.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="img/modelling-diagram.png" class="img-fluid figure-img" alt="A flowchart of the modelling process"></p>
<figcaption class="figure-caption margin-caption">Modelling process overview, adapted from <span class="citation" data-cites="complex_systems_modelling_group_modelling_2010"><a href="#ref-complex_systems_modelling_group_modelling_2010" role="doc-biblioref">Complex Systems Modelling Group 2010</a></span></figcaption>
</figure>
</div>
<p>Scoping should clearly define what problem a model is trying to solve. This affects almost all the later steps outlined above. In general, a more specific scope is more likely to lead to success, which should also be defined at the outset. Documenting the scope usually involves sign-off from oversight groups, and can reduce wasted effort or misunderstanding later in the project.</p>
</section>
<section id="modelling-approaches" class="level2 page-columns page-full" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="modelling-approaches"><span class="header-section-number">8.3</span> Modelling approaches</h2>
<p>A general principle of modelling design is to select models that are as simple as possible, but are capable of solving the defined problem. Consider the requirements for ‘explainability’ (the concept that a model and its output can be explained in a way that “makes sense” to a human) for your use case when choosing your model. For example a logistical regression model is easily communicated (see Transparency, Interpretability and Explanation).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Multiple modelling approaches may be suitable for solving one problem, with each approach having advantages and disadvantages. If capacity and feasibility allow, it’s often beneficial to use more than one technique. Similar insights provided via different approaches only add to the credibility of modelling.</p>
</div>
</div>
<p>Your choice of technique will be influenced by your ability to explain how it works to end users, and operationalise the inputs to the model. Consider this prior to choosing your model/s.</p>
<p>Below is a non-exhaustive list of categories of quantitative models and the example healthcare problems that they are used for:</p>
<table class="table">
<colgroup>
<col style="width: 28%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Example use case</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Descriptive statistics</td>
<td>Understand disease prevalence and demographics of patient cohorts</td>
</tr>
<tr class="even">
<td>Regression model</td>
<td>Relationship between risk factors vs.&nbsp;cost of cancer treatment</td>
</tr>
<tr class="odd">
<td>Classification model</td>
<td>Identify high risk patients</td>
</tr>
<tr class="even">
<td>Clustering model</td>
<td>Identify different patient cohorts</td>
</tr>
<tr class="odd">
<td>Simulations</td>
<td>Workforce planning during a pandemic using simulated disease spread trend</td>
</tr>
<tr class="even">
<td>Optimisation</td>
<td>Minimising surgeons’ overtime while planning as effectively as possible to meet surgery demands and optimise throughput</td>
</tr>
<tr class="odd">
<td>System dynamics</td>
<td>GP training plan for the next ten years given the population and workforce dynamics</td>
</tr>
<tr class="even">
<td>Language models</td>
<td>Model-aided auto coding of clinical documents</td>
</tr>
</tbody>
</table>
<p>There are numerous additional examples (also see <span class="citation" data-cites="complex_systems_modelling_group_modelling_2010"><a href="#ref-complex_systems_modelling_group_modelling_2010" role="doc-biblioref">Complex Systems Modelling Group 2010</a></span>).</p>
<div class="no-row-height column-margin column-container"></div></section>
<section id="documentation-and-management" class="level2 page-columns page-full" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="documentation-and-management"><span class="header-section-number">8.4</span> Documentation and management</h2>
<p>We highly recommend that you document all the steps of your project. Information about the software used in model development and the modelling environment itself should be comprehensively documented, including the language or software used, dependencies, and version numbers, to enable the model to be able to be reproduced. This is particularly important as packages are updated often, which can cause a change that affects the production, performance, or other aspects of a model.</p>
<p>For machine learning model management, there are open-source tools such as <a href="https://mlflow.org/">MLflow</a> that can efficiently manage the machine learning lifecycle. This includes experimentation, reproducibility, deployment, and a central model registry. Tools including <code>Docker</code>, <code>pipenv</code> and <code>renv</code> assist portability and reproducibility, and help generate documentation.</p>
<p>When communicating a model to your stakeholders, make sure you explicitly explain the assumptions on which your model has been developed, and the limitations of the model. Documentation should clearly outline the input parameters and ranges, and any implications from sensitivity analyses (see <a href="./evaluation.html#transparency-interpretability-and-explanation">Transparency, Interpretability and explanation</a>).</p>
<p><strong>Transparent Reporting of a multivariable prediction model for Individual Prognosis or Diagnosis (TRIPOD)</strong> (<span class="citation" data-cites="moons_transparent_2015"><a href="#ref-moons_transparent_2015" role="doc-biblioref">Moons et al. 2015</a></span>) is a well established and practical template used for healthcare model reporting. For simpler reporting, consider <strong>Minimum information about clinical artificial intelligence modelling: the MI-CLAIM checklist</strong> (<span class="citation" data-cites="norgeot_minimum_2020"><a href="#ref-norgeot_minimum_2020" role="doc-biblioref">Norgeot et al. 2020</a></span>) as an alternative. The EQUATOR Network, an international initiative promoting high-quality transparent health research, also has useful resources (see <strong>reference</strong>).</p>
<div class="no-row-height column-margin column-container"><div id="ref-moons_transparent_2015" class="csl-entry" role="listitem">
Moons, K G M, Altman, D G, Reitsma, J B, Ioannidis, J P A, Macaskill, P, Steyerberg, E W, Vickers, A J, Ransohoff, D F, and Collins, G S. 2015. <span>“<a href="https://doi.org/10.7326/M14-0698">Transparent reporting of a multivariable prediction model for individual prognosis or diagnosis (<span>TRIPOD</span>): Explanation and elaboration</a>”</span>. <em>Annals of Internal Medicine</em> 162.1, W1–73.
</div><div id="ref-norgeot_minimum_2020" class="csl-entry" role="listitem">
Norgeot, B, Quer, G, Beaulieu-Jones, B K, Torkamani, A, Dias, R, Gianfrancesco, M, Arnaout, R, Kohane, I S, Saria, S, Topol, E, Obermeyer, Z, Yu, B, and Butte, A J. 2020. <span>“Minimum information about clinical artificial intelligence modeling: The <span>MI</span>-<span>CLAIM</span> checklist”</span>. <em>Nature Medicine</em> 26.9, 1320–1324. <a href="https://www.nature.com/articles/s41591-020-1041-y">https://www.nature.com/articles/s41591-020-1041-y</a>.
</div><div id="ref-noauthor_mo_nodate" class="csl-entry" role="listitem">
Mō te pokapū - about the hub. <a href="https://algorithmhub.co.nz/about">https://algorithmhub.co.nz/about</a>.
</div></div><p>For key information on governance requirements, refer to the governance process and Algorithm Information Request template for the New Zealand Algorithm Hub (<span class="citation" data-cites="noauthor_mo_nodate"><a href="#ref-noauthor_mo_nodate" role="doc-biblioref">Mō te pokapū - about the hub</a></span>).</p>
<p>Documents and/or artefacts commonly related to producing and deploying a model can include:</p>
<ul>
<li>Design overview</li>
<li>Assumptions document</li>
<li>Data dictionary</li>
<li>Example of consent forms</li>
<li>Evidence of ethical approval or exemption</li>
<li>Technical documentation</li>
<li>Slide deck for communication</li>
<li>Prospective evaluation.</li>
</ul>
<p>Using a version control system such as <code>git</code> is very important for coordinating activity, avoiding rework, auditing - and generally maintaining your own sanity.</p>
</section>
<section id="modelling-tools" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="modelling-tools"><span class="header-section-number">8.5</span> Modelling tools</h2>
<p>Commonly used tools for statistical analysis and modelling that require minimum programming:</p>
<ul>
<li><p>Statistical Package for the Social Sciences (SPSS): Suitable for descriptive statistics, parametric and non-parametric analyses, and visualisation of analysis results.</p></li>
<li><p>Microsoft Excel: Easy to view initial observation over tabular data, and suitable to generate summary metrics of data and create simple data visualisations. Excel has some notable drawbacks though. including:</p>
<ul>
<li>A column and row size limit</li>
<li>Difficulty in auditing and rerunning with different data</li>
<li>Entangled data and analytics layers, which can compromise data integrity.</li>
</ul></li>
<li><p>Cloud based modelling platforms such as <a href="https://bigml.com/">BigML</a>: These platforms provide a web interface for you to easily run machine learning modelling experiments, as well as interpretability and collaborative features. However, you may need to upload your data to the cloud, which may require additional data policy checking.</p></li>
</ul>
<p>Commonly used programming tools for statistical analysis and modelling:</p>
<ul>
<li><p>R: A fully open-source software environment for statistical computing and graphics. The <a href="https://posit.co/downloads/">RStudio</a> GUI is available, and the <a href="https://rmarkdown.rstudio.com/">R Markdown</a> plug-in can facilitate R code and Markdown-based report/documentation generation, and thus collaboration. The R community is active in developing and maintaining various analysing and modelling packages. Essential packages for data science include:</p>
<ul>
<li><p>For data manipulation: <code>dplyr</code>, <code>tidyr</code>, <code>dbplyr</code>, and other <a href="https://www.tidyverse.org/">Tidyverse</a> packages</p></li>
<li><p>For modelling: <code>caret</code>, <code>e1071</code>, <code>mlr3</code></p></li>
<li><p>For visualisation: <code>ggplot2</code>, <code>plotly</code></p></li>
<li><p>For report generation: <code>knitr</code></p></li>
<li><p>For creating interactive web interfaces: <code>shiny</code></p></li>
</ul></li>
<li><p>Python: A high-level, object-oriented programming language with good code readability. Python has a comprehensive ecosystem to support common statistical analysis, machine learning, deep learning and the implementation and deployment of these data science features. Jupyter notebook/lab is a widely used tool in the Python ecosystem for shareable data science work. Many dependencies in the Python ecosystem are open-source. Essential Python dependencies for data science include:</p>
<ul>
<li><p>For data manipulation: <code>pandas</code>, <code>numpy</code></p></li>
<li><p>For statistical analysis: <code>scipy</code>, <code>statsmodels</code></p></li>
<li><p>For modelling including machine learning: <code>scikit-learn</code>, <code>statsmodels</code></p></li>
<li><p>For deep learning: <code>tensorflow</code>, <code>pytorch</code>, <code>keras</code></p></li>
<li><p>For visualisation: <code>matplotlib</code>, <code>seaborn</code>, <code>plotly</code>, <code>bokeh</code></p></li>
<li><p>For creating interactive web interfaces: <code>dash</code>, <code>streamlit</code></p></li>
</ul></li>
<li><p>SAS: A statistical software suite for data management, advanced analytics, multivariate analysis, predictive analytics and so on. SAS has its own GUI which is suitable if you’re a non-technical user, but programming via the SAS language can provide more flexibility and functionality in the analysis. It provides free SAS Ondemand for Academics (previous University Edition) for non-commercial users such as students and educators.</p></li>
<li><p>Matlab: A proprietary programming language and environment optimised for numeric computing. Matlab is powerful for linear algebra and is used for applications such as simulation and signal processing. For machine learning and deep learning, Matlab provides the Statistics and Machine Learning Toolbox and the Deep Learning Toolbox, respectively.</p></li>
</ul>
<p>Open source tools such as R and Python are a great place for you to start as they provide transparency, the ability to collaborate, and have a low barrier to entry in terms of cost. However, they may not work in practice in every use case, and we’re not clear on how stable these tools will remain following version changes over time. Commercial tools tend to have a higher cost than their open source counterparts, but offer more controlled and supported experiences.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Check the license terms for the tools you’re using. Models developed using some commercial tools may not be able to be used in a specific deployment environment.</p>
</div>
</div>
</section>
<section id="experiment-tracking-tools" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="experiment-tracking-tools"><span class="header-section-number">8.6</span> Experiment tracking tools</h2>
<p>Model development is an iterative process and it takes time to find an optimal set of configurations for the problem you are trying to solve. Monitoring experiment configurations and model performance can be cumbersome, especially when the complexity of a model grows. There are many experiment tracking tools available to help you with machine learning model development, such as <a href="https://neptune.ai/blog/best-ml-experiment-tracking-tools">this list from Neptune.ai</a>.</p>
</section>
<section id="model-validation" class="level2 page-columns page-full" data-number="8.7">
<h2 data-number="8.7" class="anchored" data-anchor-id="model-validation"><span class="header-section-number">8.7</span> Model validation</h2>
<section id="data-partitioning" class="level3 page-columns page-full" data-number="8.7.1">
<h3 data-number="8.7.1" class="anchored" data-anchor-id="data-partitioning"><span class="header-section-number">8.7.1</span> Data partitioning</h3>
<p>Models are usually tuned to the dataset that they are trained with. Using independent datasets for validating the performance of a model is preferred. However, in the healthcare domain, data sharing can make this difficult.</p>
<p>When independent datasets aren’t available, your model needs to be validated using the development dataset. There are two main approaches for train-test data splitting and model validation.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Bootstrapping (multiple samples with replacement) can also be used for model development, with models evaluated with an “out of bag” sample. Bootstrap sampling is embedded in boosting and bagging algorithms.</p>
</div>
</div>
<ol type="1">
<li>Cross validation</li>
</ol>
<p>This method mixes and shuffles all data points and splits them into <code>k</code> folds (usually 5-10) for iterative performance measuring. In each iteration, one fold is left out as the testing set and the others are used as the training set. By these iterations, <code>k</code> measures of the chosen performance metric(s) can be obtained to assess the model’s average performance and variance, which is used as an estimate of the model’s performance on unseen data.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="http://ethen8181.github.io/machine-learning/model_selection/img/kfolds.png"><img src="./img/kfolds.png" class="img-fluid figure-img" alt="Example of k-fold cross validation"></a></p>
<figcaption class="figure-caption margin-caption">Example of K-Fold Cross Validation when k=5</figcaption>
</figure>
</div>
<p>When using cross validation, it’s important you ensure there are no significant data changes across time within the model development dataset. For example, if a policy change was implemented at a date in the middle of your dataset time range - this may impact the data and affect model performance at some time post that date. You will also want to ensure that there are no foreseeable data changes between the development set and the future data that the model would be applied on. In healthcare, it’s also important to check whether the model will be used at an event level (e.g.&nbsp;a hospitalisation event or GP visit) or patient level in advance.</p>
<p>:::{.callout-tip} There could be multiple events for the same patient in a dataset. If no proper consideration is taken into account while splitting the testing data (or other preprocessing like deduplication), this could potentially lead to information leakage and inaccuracy. :::</p>
<p>For example, in a longitudinal dataset of health encounters, the dataset could be split to group all of a patient’s encounters together (so these are not split across sets), or split by time (which could mean a patient’s encounters are split between different validation sets). You should consider whether these types of splitting will make a meaningful difference to your validation exercises. Also be mindful of anything that involves a flow or transfer.</p>
<ol start="2" type="1">
<li>Time-wise validation</li>
</ol>
<p>Many healthcare model applications have a time dimension, as data is collected by healthcare events that happen across time. There may be a trend in the data as people age, population structure changes, and healthcare technologies and systems evolve.</p>
<p>To better estimate the future performance of a model, a time-wise splitting and validating approach should be taken. This method sets data of a specified period along time as the testing set and uses the data before the testing set as training data. A visualisation of performance change over time will be obtained after a number of iterations, which provides an estimation of the trend of the model’s performance change in the near future - whether it will it be relatively stable, gradually decreasing or increasing.</p>
<p>Some models have a complex <a href="https://towardsdatascience.com/navigating-the-hyperparameter-space-32f48be2c12d">hyperparameter space</a> and require an additional split of data for early stop-in training or additional hyperparameter optimisation. In classification models that rely on a cut-off threshold in application (for example, a high-risk patient identification model based on numeric risk scores), the cut-off threshold can also be seen as part of the model hyperparameters, and its determination should be considered as part of the model development. As a result, the performance validation process should be using a partition of data that is not used in either model training, additional hyperparameter optimisation, or the threshold optimisation in particular.</p>
<p>In all cases, you should take care to ensure that the sampling unit is complete. For instance, you may be modelling a flow of events, in which case the sampling unit is likely to be a patient. If the modelled data consists of multiple records per patient, it’s important to ensure that complete patient records are sampled.</p>
</section>
<section id="performance-metrics" class="level3" data-number="8.7.2">
<h3 data-number="8.7.2" class="anchored" data-anchor-id="performance-metrics"><span class="header-section-number">8.7.2</span> Performance metrics</h3>
<p>To assess model performance, the type of performance metric you use (as outlined below) will depend on the model being evaluated and the context of the project. For models that predict a value, such as a linear regression model, R-squared and root mean square error (RMSE) are common.</p>
<p>In health, metrics calculated from a <a href="https://en.wikipedia.org/wiki/Confusion_matrix">confusion matrix</a> for models that output a class (e.g.&nbsp;a decision tree) or probability (e.g.&nbsp;logistic regression) are commonly used. To produce a confusion matrix for a model that outputs a probability, a probability threshold is applied (where values above the threshold are positive and values below are negative). The probability threshold can be set to optimise a particular metric, can be set by other optimisation techniques, or otherwise set according to the use case. Seek clinical input on the appropriate thresholds as they can impact patient care.</p>
<p>There are a number of common performance metrics that can be used (although it’s important to note that not all are appropriate for each model or data type or question being answered):</p>
<ul>
<li><p><strong>Precision</strong> - quantifies the proportion of positive class predictions that actually belong to the positive class</p></li>
<li><p><strong>Recall</strong> - quantifies the number of positive class predictions made out of all positive examples in the dataset</p></li>
<li><p><strong>Model</strong> accuracy - a machine learning classification model performance metric that’s defined as the ratio of true positives and true negatives to all positive and negative observations</p></li>
<li><p><strong>F-Measure</strong> - provides a single score that balances both the concerns of precision and recall in one number</p></li>
<li><p><strong>Positive and negative predictive values</strong> (PPV and NPV respectively) are the proportions of positive and negative results in statistics and diagnostic tests that are true positive and true negative results, respectively. The PPV and NPV describe the performance of a diagnostic test or other statistical measure. PPV and NPV are best described as the clinical relevance of a test.</p></li>
<li><p><strong>Prevalence</strong> - the number of cases in a defined population at a single point in time and is expressed as a decimal or a percentage</p></li>
<li><p><strong>Sensitivity</strong> - the percentage of true positives (for example, 90% sensitivity = 90% of people who have the target disease will test positive)</p></li>
<li><p><strong>Specificity</strong> - the percentage of true negatives (for example, 90% specificity = 90% of people who do not have the target disease will test negative)</p></li>
<li><p><strong>AUC-ROC</strong> - a performance metric for “discrimination”; it tells you about the model’s ability to discriminate between cases (positive examples) and non-cases (negative examples). For a ranking use case AUC-ROC is a measure that indicates how good the model is at ranking cases based on a score (how likely any two cases are correctly ordered). 0.5 indicates that the model is no better than random at ranking and 1 indicates a perfect model.</p></li>
<li><p><strong>AUC-PRC</strong> - a measure that indicates how good the model is at minimising the trade-off between precision and recall. A high AUC-PRC shows that the model can achieve high recall and high precision at the same time.</p></li>
</ul>
</section>
</section>
<section id="useful-resources" class="level2 page-columns page-full" data-number="8.8">
<h2 data-number="8.8" class="anchored" data-anchor-id="useful-resources"><span class="header-section-number">8.8</span> Useful resources</h2>
<ul>
<li><p><a href="https://developers.google.com/machine-learning/guides/rules-of-ml#overview">Rules of Machine Learning: Best Practices for ML Engineering</a> (Google Machine Learning Guides)</p></li>
<li><p>Ten rules for the credible practice of modelling nd simulation in healthcare (<span class="citation" data-cites="erdemir_credible_2020"><a href="#ref-erdemir_credible_2020" role="doc-biblioref">Erdemir et al. 2020</a></span>)</p></li>
<li><p>Book on modelling in healthcare (<span class="citation" data-cites="complex_systems_modelling_group_modelling_2010"><a href="#ref-complex_systems_modelling_group_modelling_2010" role="doc-biblioref">Complex Systems Modelling Group 2010</a></span>)</p></li>
<li><p><a href="https://eugeneyan.com/writing/practical-guide-to-maintaining-machine-learning/">A Practical Guide to Maintaining Machine Learning in Production</a></p></li>
<li><p>Model cards for model reporting (<span class="citation" data-cites="mitchell_model_2019"><a href="#ref-mitchell_model_2019" role="doc-biblioref">Mitchell et al. 2019</a></span>)</p></li>
</ul>


<div class="no-row-height column-margin column-container"><div id="ref-erdemir_credible_2020" class="csl-entry" role="listitem">
Erdemir, A, Mulugeta, L, Ku, J P, Drach, A, Horner, M, Morrison, T M, Peng, G C Y, Vadigepalli, R, Lytton, W W, and Myers, J G. 2020. <span>“Credible practice of modeling and simulation in healthcare: Ten rules from a multidisciplinary perspective”</span>. <em>Journal of Translational Medicine</em> 18.1, 369. <a href="https://doi.org/10.1186/s12967-020-02540-4">https://doi.org/10.1186/s12967-020-02540-4</a>.
</div><div id="ref-complex_systems_modelling_group_modelling_2010" class="csl-entry" role="listitem">
Complex Systems Modelling Group. 2010. <em>Modelling in healthcare</em>. Providence, Rhode Island. <a href="http://www.ams.org/mbk/074">http://www.ams.org/mbk/074</a>.
</div><div id="ref-mitchell_model_2019" class="csl-entry" role="listitem">
Mitchell, M, Wu, S, Zaldivar, A, Barnes, P, Vasserman, L, Hutchinson, B, Spitzer, E, Raji, I D, and Gebru, T. 2019. <span>“Model cards for model reporting”</span>. in <em>Proceedings of the conference on fairness, accountability, and transparency</em>., 220–229. <a href="https://dl.acm.org/doi/10.1145/3287560.3287596">https://dl.acm.org/doi/10.1145/3287560.3287596</a>.
</div></div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data-preparation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data preparation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./evaluation.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Evaluation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>